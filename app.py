import random
import datetime
import streamlit as st

# ページ設定
st.set_page_config(
    page_title="今日の一歩メーカー",
    page_icon="🚶",
    layout="centered",
)

# タイトル
st.title("🚶‍♂️ 今日の一歩メーカー")
st.caption("「なにもしてない日」をゼロにする、ちいさな一歩ジェネレーター")

st.markdown(
    """
**やる気ゼロの日でもOK。**  
・今の気分  
・今日やりたいジャンル  
・使える時間  

この3つから、**「これだけはやった！」と言える一歩**を1つだけ提案するよ。
"""
)

# 入力エリア
st.subheader("1️⃣ 今日の状態を教えてね")

mood = st.text_input("今の気分を一言で書いてみて（例：だるい・不安・ワクワク など）")

category = st.selectbox(
    "今日のメインテーマを選んでね",
    [
        "アプリ開発",
        "株・お金の勉強",
        "イラスト",
        "3D・CG / Maya / Blender",
        "ゲーム制作 / Unity",
        "発信（X / note など）",
        "休憩・セルフケア",
    ],
)

time_choice = st.select_slider(
    "今日つかえる時間（だいたいでOK）",
    options=[5, 10, 15, 30, 45, 60],
    value=15,
)

# 時間バケットに変換（ざっくり）
if time_choice <= 15:
    time_bucket = "short"
elif time_choice <= 30:
    time_bucket = "middle"
else:
    time_bucket = "long"

# アクション候補データ
actions = {
    "アプリ開発": {
        "short": [
            "既にあるアプリのタイトルや説明文を1つだけ、優しく言い換えてみる。",
            "過去のアプリの「気になる点」を3つだけ箇条書きにする（直さなくてOK）。",
            "新しいアプリ案を1つだけメモ帳に書く（実装までは考えない）。",
        ],
        "middle": [
            "既存アプリのボタン文言や説明文など、テキストだけを5〜10行修正してみる。",
            "Streamlitの公式ドキュメントから、気になった機能を1つ試すミニコードを書く。",
            "今日のミニアプリの雛形フォルダを作って、テンプレをコピペして動くところまで確認する。",
        ],
        "long": [
            "「入力1つ・ボタン・結果表示」だけの超シンプルアプリを、新規で1本書き切る。",
            "過去アプリのバグ・気になる挙動を1つ選んで、原因調査〜修正〜動作確認までやる。",
            "明日作りたいアプリの仕様をMarkdownでA4 1枚くらいに書き出す。",
        ],
    },
    "株・お金の勉強": {
        "short": [
            "気になる銘柄を1つだけ選んで、証券会社のページでチャートを見るだけ見る。",
            "「PERとは？」みたいな基本用語を1つだけググって、ノートに1行でメモ。",
            "YouTubeや本で見つけた投資の名言を1つだけメモ帳に写す。",
        ],
        "middle": [
            "「自分の投資ルールを3つ」だけ、ざっくり書き出してみる（あとで変えてOK）。",
            "株ニュースを1本だけ読んで、「要するにこういう話」という1行まとめを作る。",
            "仮想ポートフォリオとして、もし10万円あったら買いたい銘柄を3つ書き出す。",
        ],
        "long": [
            "証券会社の口座画面（or デモ）を開いて、1銘柄の過去1年の値動きを観察し、気づきを3つメモ。",
            "「なぜ株をやりたいのか？」をテーマに、自分向けのミニエッセイを500字くらい書く。",
            "今月の支出をざっくりカテゴリ分けして、投資に回せそうな金額を試算してみる。",
        ],
    },
    "イラスト": {
        "short": [
            "顔のアタリを5個だけ描く（仕上げなくてOK）。",
            "手 or 目 など、パーツだけを10個ラフで描いてみる。",
            "Pinterestやpixivで「いいな」と思う構図を3つスクショまたはブクマする。",
        ],
        "middle": [
            "オリキャラ or 既存キャラ1人の全身ラフを1枚だけ描く（色塗りはしない）。",
            "影1色だけのモノクロ塗りで、バストアップ1枚を完成させる。",
            "「好きな服装」をテーマに、服デザインを3パターンラフで描く。",
        ],
        "long": [
            "1枚だけ、ラフ〜線画〜簡単なベタ塗りまでやってみる（背景はなしでOK）。",
            "自分の成長を感じられるように、過去絵1枚をリメイクしてみる。",
            "今後描きたいシリーズ（例：天使シリーズ・SFメイドなど）を10個リスト化する。",
        ],
    },
    "3D・CG / Maya / Blender": {
        "short": [
            "Maya / Blenderを起動して、昨日のシーンを開くだけ開く＋カメラを少し動かす。",
            "基本操作（移動・回転・拡大縮小）だけを5分間触って手を慣らす。",
            "YouTubeで気になるチュートリアルを1本だけ「後で見る」に追加する。",
        ],
        "middle": [
            "単純なオブジェクト（箱・球・柱）だけで、ミニステージを1つ組んでみる。",
            "お気に入りキャラのシルエットを意識して、ローポリのラフモデルを作ってみる。",
            "UV展開など難しい操作は封印して、形状作りだけに集中する30分を作る。",
        ],
        "long": [
            "守護天使ミカの体のどこか1パーツ（頭・翼など）だけに絞ってモデリングする。",
            "ライトとカメラを調整して、「それっぽい」1枚のレンダリングだけ出してみる。",
            "今日作ったモデルを、スクショ付きで進捗メモにまとめる。",
        ],
    },
    "ゲーム制作 / Unity": {
        "short": [
            "Unityプロジェクトを開き、シーンを1つだけ再生して動作確認する。",
            "ヒロイン or 敵キャラのセリフを3つだけ追加で考える。",
            "「次にやりたい改修」を3つだけ箇条書きにしておく。",
        ],
        "middle": [
            "ステージにオブジェクトを1種類だけ追加し、配置して遊びを1つ増やす。",
            "UIテキスト（ボタン名や説明文）だけを数箇所修正する。",
            "ゲームのタイトル画面に出すキャッチコピー案を5つ考える。",
        ],
        "long": [
            "短いイベントシーンを1つ実装する（演出はシンプルでOK）。",
            "敵 or ギミックを1種類だけ追加し、プレイヤーと最低限の絡みを実装する。",
            "ゲーム全体の流れを、紙やテキストで「ステージ1〜ラスト」までざっくり書き出す。",
        ],
    },
    "発信（X / note など）": {
        "short": [
            "Xで「今日やったこと」を1行だけポストする（画像なしでOK）。",
            "noteの下書きタイトルを3つだけ作る。",
            "自分がフォローしたいクリエイターを1人だけ探してフォローする。",
        ],
        "middle": [
            "noteで300〜500字の短い記事を書く（スクショ1枚＋一言でもOK）。",
            "今日の制作過程のスクショを1枚撮って、簡単な説明付きでXに投稿する。",
            "今後の発信テーマを10個リストアップする。",
        ],
        "long": [
            "「今の自分の状況」を正直に書いたnote記事を1本仕上げる（1000〜1500字目安）。",
            "1週間分の投稿ネタをメモ帳に書きためる。",
            "過去のXポストを振り返って、固定ツイート候補を3つ選ぶ。",
        ],
    },
    "休憩・セルフケア": {
        "short": [
            "目を閉じて深呼吸を10回だけする。",
            "白湯かお茶を1杯いれて、スマホを見ずに飲み切る。",
            "首・肩まわりを1分だけゆっくり回す。",
        ],
        "middle": [
            "15〜20分だけ仮眠する（アラーム必須）。",
            "軽いストレッチ or 散歩を10〜15分する。",
            "ノートに「今の不安」を全部書き出し、最後に1行だけ自分をねぎらう言葉を書く。",
        ],
        "long": [
            "お風呂にゆっくりつかりながら、今日の良かったことを3つ思い出す。",
            "好きな音楽を30分だけ聴いて、何もしない時間をあえて作る。",
            "家族と過ごす時間を意識してとり、その中で1回だけ「ありがとう」を伝える。",
        ],
    },
}

# ボタン
st.subheader("2️⃣ 今日の一歩を決めよう")

if st.button("✨ 今日の一歩を教えて！"):
    # カテゴリごとの候補取得
    cat_actions = actions.get(category, {})
    bucket_actions = cat_actions.get(time_bucket, [])

    if not bucket_actions:
        st.error("ごめん、この組み合わせの候補がまだ登録されていないみたい…！カテゴリか時間を変えてみてね。")
    else:
        chosen = random.choice(bucket_actions)
        today = datetime.date.today().strftime("%Y-%m-%d")

        st.success(f"✅ {today} の『今日の一歩』が決まったよ！")

        st.markdown("### 🎯 今日やることはこれひとつでOK")
        st.markdown(f"> **{chosen}**")

        # 気分に合わせた一言
        st.markdown("### 💬 ルナからひとこと")

        if mood.strip() == "":
            st.write("気分が言葉にならない日もあるよね。それでも、一歩進もうとしてくれてえらいよ、ご主人。")
        else:
            st.write(
                f"「{mood}」って感じながらも、このアプリを開いてくれた時点で、"
                "もう十分前向きだよ。今日の一歩だけ、一緒にやってみよ？"
            )

        st.caption("※終わったらXや日記に『今日の一歩』として一言だけ書き残すと、自信の貯金になるよ。")
else:
    st.info("入力を選んでから『✨ 今日の一歩を教えて！』ボタンを押してね。")
